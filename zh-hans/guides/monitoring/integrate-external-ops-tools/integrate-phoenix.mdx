---
title: 集成 Phoenix
---

### Phoenix 简介

开源且基于OpenTelemetry的可观测性、评估、提示工程和实验平台，适用于您的LLM工作流程和代理。

<Callout>
Phoenix [官网介绍](https://phoenix.arize.com)
</Callout>

***

### 配置 Phoenix

本章节将指引你注册 Phoenix 并将其集成至 天智 平台内。

#### 1. 注册/登录 [Phoenix](https://app.arize.com/auth/phoenix/signup)

### 2. 获取 Phoenix API 密钥

从右上角的用户菜单中获取 Phoenix API 密钥。点击 **API Key**，然后点击 API Key 进行复制：

<img
src="https://i.ibb.co/pB1W0pk8/dify-docs-phoenix-api-key.png"
className="mx-auto"
alt=""
/>

### 3. 集成 Phoenix 与 天智

在 天智 应用程序中配置 Phoenix。打开需要监控的应用程序，在侧边菜单中打开**监控**，并在页面上选择**追踪应用性能**。

<img
src="https://i.ibb.co/gMmXxfhQ/dify-docs-phoenix-in-use.png"
className="mx-auto"
alt=""
/>

点击配置后，将在 Phoenix 中创建的 **API Key** 和**项目名称**粘贴到配置中并保存。

<img
src="https://i.ibb.co/jv6QFbp7/dify-docs-phoenix-config.png"
className="mx-auto"
alt=""
/>

成功保存后，你可以在当前页面查看监控状态。

<img
src="https://i.ibb.co/HTJsj9x2/dify-docs-phoenix-in-service.png"
className="mx-auto"
alt=""
/>

### 配置 Phoenix Cloud

本章节将指引你注册 Phoenix Cloud 并将其集成至 天智 平台内。

#### 1. 注册/登录 [Phoenix Cloud](https://app.arize.com/auth/phoenix/signup)

### 2. 创建你的 Phoenix 空间

你可以在右上角的用户菜单中创建 Phoenix 空间。点击 创建空间，然后为你的空间提供一个唯一的 URL 标识符：

<img
src="https://i.ibb.co/7JYPzZBf/dify-docs-phoenix-cloud-create-space.png"
className="mx-auto"
alt=""
/>

保存成功后，你可以在概览页面查看空间的状态。

<img
src="https://i.ibb.co/Z6RqMhhq/dify-docs-phoenix-cloud-space-overview.png"
className="mx-auto"
alt=""
/>

### 3. 创建你的 Phoenix API 密钥

启动空间后，你可以在左下角的用户菜单中点击 设置 来创建 Phoenix API 密钥。点击 系统密钥，然后为你的 API 密钥命名：

<img
src="https://i.ibb.co/SXMyX9K3/dify-docs-phoenix-cloud-api-key.png"
className="mx-auto"
alt=""
/>

### 4. 集成 Phoenix Cloud 与 天智

在 天智 应用程序中配置 Phoenix。打开需要监控的应用程序，在侧边菜单中打开**监控**，并在页面上选择**追踪应用性能**。

<img
src="https://i.ibb.co/gMmXxfhQ/dify-docs-phoenix-in-use.png"
className="mx-auto"
alt=""
/>

点击配置后，粘贴从 Phoenix Cloud 中获取的 API 密钥、项目名称 和 空间主机名 到配置项中并保存。

<img
src="https://i.ibb.co/jv6QFbp7/dify-docs-phoenix-config.png"
className="mx-auto"
alt=""
/>

成功保存后，你可以在当前页面查看监控状态。

<img
src="https://i.ibb.co/HTJsj9x2/dify-docs-phoenix-in-service.png"
className="mx-auto"
alt=""
/>

## 监控数据列表

### **工作流/对话流追踪信息**

**用于追踪工作流和对话流**

| 工作流                              | Phoenix 追踪                   |
| ---------------------------------- | -------------------------- |
| workflow_app_log_id/workflow_run_id | id                         |
| user_session_id                     | - 放置在元数据中            |
| `workflow_{id}`                      | name                       |
| start_time                          | start_time                 |
| end_time                            | end_time                   |
| inputs                              | inputs                     |
| outputs                             | outputs                    |
| Model token consumption             | usage_metadata             |
| metadata                            | metadata                   |
| error                               | error                      |
| \[workflow]                         | tags                       |
| conversation_id/none for workflow | conversation_id in metadata |

**工作流追踪信息**

- workflow_id - 工作流唯一标识符
- conversation_id - 对话 ID
- workflow_run_id - 当前运行的 ID
- tenant_id - 租户 ID
- elapsed_time - 当前运行所用时间
- status - 运行状态
- version - 工作流版本
- total_tokens - 当前运行使用的总令牌数
- file_list - 处理的文件列表
- triggered_from - 触发当前运行的来源
- workflow_run_inputs - 当前运行的输入数据
- workflow_run_outputs - 当前运行的输出数据
- error - 当前运行期间遇到的错误
- query - 运行期间使用的查询
- workflow_app_log_id - 工作流应用程序日志 ID
- message_id - 关联的消息 ID
- start_time - 运行开始时间
- end_time - 运行结束时间
- workflow node executions - 工作流节点执行信息
- 元数据
  - workflow_id - 工作流唯一标识符
  - conversation_id - 对话 ID
  - workflow_run_id - 当前运行的 ID
  - tenant_id - 租户 ID
  - elapsed_time - 当前运行所用时间
  - status - 运行状态
  - version - 工作流版本
  - total_tokens - 当前运行使用的总令牌数
  - file_list - 处理的文件列表
  - triggered_from - 触发当前运行的来源

#### **消息追踪信息**

**用于追踪 LLM 相关对话**

| 聊天                            | Phoenix LLM                    |
| ------------------------------- | --------------------------- |
| message_id                      | id                          |
| user_session_id                 | - 放置在元数据中             |
| "llm"                           | name                        |
| start_time                      | start_time                  |
| end_time                        | end_time                    |
| inputs                          | inputs                      |
| outputs                         | outputs                     |
| Model token consumption         | usage_metadata              |
| metadata                        | metadata                    |
| \["message", conversation_mode] | tags                        |
| conversation_id                 | conversation_id in metadata |

**消息追踪信息**

- message_id - 消息 ID
- message_data - 消息数据
- user_session_id - 用户会话 ID
- conversation_model - 对话模式
- message_tokens - 消息中的令牌数
- answer_tokens - 答案中的令牌数
- total_tokens - 消息和答案中的总令牌数
- error - 错误信息
- inputs - 输入数据
- outputs - 输出数据
- file_list - 处理的文件列表
- start_time - 开始时间
- end_time - 结束时间
- message_file_data - 与消息关联的文件数据
- conversation_mode - 对话模式
- 元数据
  - conversation_id - 对话 ID
  - ls_provider - 模型提供商
  - ls_model_name - 模型 ID
  - status - 消息状态
  - from_end_user_id - 发送用户的 ID
  - from_account_id - 发送账户的 ID
  - agent_based - 消息是否基于代理
  - workflow_run_id - 工作流运行 ID
  - from_source - 消息来源

#### **审核追踪信息**

**用于追踪对话审核**

| 审核           | Phoenix Tool         |
| -------------- | ----------------- |
| user_id        | - 放置在元数据中   |
| "moderation"   | name              |
| start_time     | start_time        |
| end_time       | end_time          |
| inputs         | inputs            |
| outputs        | outputs           |
| metadata       | metadata          |
| \["moderation"]| tags              |

**审核追踪信息**

- message_id - 消息 ID
- user_id - 用户 ID
- workflow_app_log_id - 工作流应用程序日志 ID
- inputs - 审核输入数据
- message_data - 消息数据
- flagged - 内容是否被标记需要注意
- action - 采取的具体行动
- preset_response - 预设响应
- start_time - 审核开始时间
- end_time - 审核结束时间
- 元数据
  - message_id - 消息 ID
  - action - 采取的具体行动
  - preset_response - 预设响应

#### **建议问题追踪信息**

**用于追踪建议问题**

| 建议问题              | Phoenix LLM          |
| --------------------- | ----------------- |
| user_id               | - 放置在元数据中   |
| "suggested_question"  | name              |
| start_time            | start_time        |
| end_time              | end_time          |
| inputs                | inputs            |
| outputs               | outputs           |
| metadata              | metadata          |
| \["suggested_question"]| tags             |

**消息追踪信息**

- message_id - 消息 ID
- message_data - 消息数据
- inputs - 输入内容
- outputs - 输出内容
- start_time - 开始时间
- end_time - 结束时间
- total_tokens - 令牌数量
- status - 消息状态
- error - 错误信息
- from_account_id - 发送账户的 ID
- agent_based - 是否基于代理
- from_source - 消息来源
- model_provider - 模型提供商
- model_id - 模型 ID
- suggested_question - 建议问题
- level - 状态级别
- status_message - 状态消息
- 元数据
  - message_id - 消息 ID
  - ls_provider - 模型提供商
  - ls_model_name - 模型 ID
  - status - 消息状态
  - from_end_user_id - 发送用户的 ID
  - from_account_id - 发送账户的 ID
  - workflow_run_id - 工作流运行 ID
  - from_source - 消息来源

#### **数据集检索追踪信息**

**用于追踪知识库检索**

| 数据集检索           | Phoenix Retriever    |
| ------------------- | ----------------- |
| user_id             | - 放置在元数据中   |
| "dataset_retrieval" | name              |
| start_time          | start_time        |
| end_time            | end_time          |
| inputs              | inputs            |
| outputs             | outputs           |
| metadata            | metadata          |
| \["dataset_retrieval"]| tags            |
| message_id          | parent_run_id     |

**数据集检索追踪信息**

- message_id - 消息 ID
- inputs - 输入内容
- documents - 文档数据
- start_time - 开始时间
- end_time - 结束时间
- message_data - 消息数据
- 元数据
  - message_id - 消息 ID
  - ls_provider - 模型提供商
  - ls_model_name - 模型 ID
  - status - 消息状态
  - from_end_user_id - 发送用户的 ID
  - from_account_id - 发送账户的 ID
  - agent_based - 是否基于代理
  - workflow_run_id - 工作流运行 ID
  - from_source - 消息来源

#### **工具追踪信息**

**用于追踪工具调用**

| 工具                  | Phoenix Tool         |
| -------------------- | ----------------- |
| user_id              | - 放置在元数据中   |
| tool_name            | name              |
| start_time           | start_time        |
| end_time             | end_time          |
| inputs               | inputs            |
| outputs              | outputs           |
| metadata             | metadata          |
| \["tool", tool_name] | tags              |

#### **工具追踪信息**

- message_id - 消息 ID
- tool_name - 工具名称
- start_time - 开始时间
- end_time - 结束时间
- tool_inputs - 工具输入
- tool_outputs - 工具输出
- message_data - 消息数据
- error - 错误信息（如果有）
- inputs - 消息的输入
- outputs - 消息的输出
- tool_config - 工具配置
- time_cost - 时间消耗
- tool_parameters - 工具参数
- file_url - 关联文件的 URL
- 元数据
  - message_id - 消息 ID
  - tool_name - 工具名称
  - tool_inputs - 工具输入
  - tool_outputs - 工具输出
  - tool_config - 工具配置
  - time_cost - 时间消耗
  - error - 错误信息（如果有）
  - tool_parameters - 工具参数
  - message_file_id - 消息文件 ID
  - created_by_role - 创建者角色
  - created_user_id - 创建者用户 ID

#### **生成名称追踪信息**

**用于追踪对话标题生成**

| 生成名称                      | Phoenix Tool         |
| ---------------------------- | ----------------- |
| user_id                      | - 放置在元数据中   |
| "generate_conversation_name" | name              |
| start_time                   | start_time        |
| end_time                     | end_time          |
| inputs                       | inputs            |
| outputs                      | outputs           |
| metadata                     | metadata          |
| \["generate_name"]           | tags              |

**生成名称追踪信息**

- conversation_id - 对话 ID
- inputs - 输入数据
- outputs - 生成的对话名称
- start_time - 开始时间
- end_time - 结束时间
- tenant_id - 租户 ID
- 元数据
  - conversation_id - 对话 ID
  - tenant_id - 租户 ID

{/*
Contributing Section
DO NOT edit this section!
It will be automatically generated by the script.
*/}

---

[编辑此页面](https://github.com/langgenius/dify-docs/edit/main/zh-hans/guides/monitoring/integrate-external-ops-tools/integrate-phoenix.mdx) | [提交问题](https://github.com/langgenius/dify-docs/issues/new?template=docs.yml)

