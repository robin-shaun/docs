---
title: コミュニティ版を v1.0.0+ にアップグレードする
---


> この記事では、旧コミュニティ版を [v1.0.0](https://github.com/langgenius/dify/releases/tag/1.0.0) にアップグレードする方法を説明します。もし Dify コミュニティ版をまだインストールしていない場合は、[Dify プロジェクト](https://github.com/langgenius/dify)をクローンし、`1.0.0` ブランチに切り替えてください。[ドキュメント](/ja-jp/getting-started/install-self-hosted/docker-compose)を参照してインストールコマンドを実行してください。

コミュニティ版でプラグイン機能を体験するには、バージョンを v1.0.0 にアップグレードする必要があります。この記事では、旧バージョンから `v1.0.0` にアップグレードしてプラグインエコシステム機能を体験する方法を説明します。

## アップグレード開始

アップグレードは以下の手順で行います：

1. データのバックアップ
2. プラグインの移行
3. メインプロジェクトのアップグレード

### 1. データのバックアップ

1.1 `cd` コマンドで Dify プロジェクトのパスに移動し、バックアップ用のブランチを作成します。

1.2 次のコマンドを実行して、docker-compose YAML ファイルをバックアップします（オプション）。

```bash
cd docker
cp docker-compose.yaml docker-compose.yaml.$(date +%s).bak
```

1.3 サービスを停止するために以下のコマンドを実行し、Docker ディレクトリでデータバックアップを作成します。

```bash
docker compose down
tar -cvf volumes-$(date +%s).tgz volumes
```

### 2. バージョンアップ

`v1.0.0` は Docker Compose を使用してデプロイできます。`cd` コマンドで Dify プロジェクトのパスに移動し、以下のコマンドで Dify のバージョンをアップグレードします：

```bash
git fetch origin
git checkout 1.0.0 # 1.0.0 ブランチに切り替える
cd docker
nano .env # .env.example ファイルと同期するように環境構成ファイルを変更する
docker compose -f docker-compose.yaml up -d
```

### 3. ツールの移行をプラグインに変換

> **重要な注意点：コマンド実行とパッケージ管理について**
> *   **デフォルトのコンテナ名:** `docker exec` コマンドの例では `docker-api-1` を使用しています。APIコンテナ名やIDが異なる場合（`docker ps` で確認可能）は、コマンドを適宜修正してください。
> *   **Pythonパッケージマネージャー (`uv` vs `poetry`):**
    *   Difyは、パフォーマンス向上のため、バージョン [v1.3.0](https://github.com/langgenius/dify/releases/tag/1.3.0) からPythonパッケージマネージャーを `poetry` から `uv` に切り替えました。Dify v1.3.0以降の一般的な操作では、標準コマンドは `uv run flask ...` です。
    *   **このガイドはDify v1.0.0へのアップグレードに焦点を当てています。** Dify v1.0.0からv1.3.0（v1.3.0を含まない）までの期間は、`poetry` がパッケージマネージャーでした。そのため、以下の例の `flask` コマンドは `poetry run ...` を正しく使用しています。コード例では、まず現在の `uv` の標準をコメントで強調し、次にこのガイドの特定のv1.0.0移行スコープに関連する `poetry` コマンドを示しています。

このステップでは、以前のコミュニティ版で使用していたツールやモデルプロバイダを自動的にデータ移行し、新しいバージョンのプラグイン環境にインストールします。

1. `docker ps` コマンドを実行して、APIコンテナの名前またはIDを確認します。デフォルトは多くの場合 `docker-api-1` です。

例：

```bash
docker ps
CONTAINER ID   IMAGE                                       COMMAND                  CREATED       STATUS                 PORTS                                                                                                                             NAMES
417241cd****   nginx:latest                                "sh -c 'cp /docker-e…"   3 hours ago   Up 3 hours             0.0.0.0:80->80/tcp, :::80->80/tcp, 0.0.0.0:443->443/tcp, :::443->443/tcp                                                          docker-nginx-1
f84aa773****   langgenius/dify-api:1.0.0                   "/bin/bash /entrypoi…"   3 hours ago   Up 3 hours             5001/tcp                                                                                                                          docker-worker-1
a3cb19c2****   langgenius/dify-api:1.0.0                   "/bin/bash /entrypoi…"   3 hours ago   Up 3 hours             5001/tcp                                                                                                                          docker-api-1
```

`docker exec -it docker-api-1 bash` コマンドを実行してコンテナのターミナルにアクセスし（コンテナ名が異なる場合は、その名前を使用してください）、以下を実行します：

```bash
# Dify v1.3.0以降の環境では、標準コマンドは 'uv run ...' です。
uv run flask extract-plugins --workers=20
#
# 移行対象バージョンがDify v1.0.0からv1.3.0（v1.3.0を含まない）までの場合は、'poetry'を使用してください:
# poetry run flask extract-plugins --workers=20
```

> v1.0.0移行のためにこのガイドに従ってコマンドを実行しようとしてエラー（例：`uv`または`poetry`が見つからない）が発生した場合、そのバージョンの元の前提条件に従ってサーバーに`poetry`環境が正しくセットアップされていることを確認してください。 `poetry`コマンドの実行後に端末が入力を求めてきた場合は、「Enter」を押してスキップします。

このコマンドは、現在の環境で使用しているすべてのモデルとツールを抽出します。workers パラメータは並行プロセス数を決定し、必要に応じて調整できます。コマンドが終了すると、結果が保存される `plugins.jsonl` ファイルが生成されます。このファイルには、現在の Dify インスタンス内のすべてのワークスペースのプラグイン情報が含まれます。

インターネット接続が正常で、`https://marketplace.dify.ai` にアクセスできることを確認してください。`docker-api-1` コンテナ内で以下のコマンドを実行します：

```bash
# Dify v1.3.0以降の環境では、標準コマンドは 'uv run ...' です。
uv run flask install-plugins --workers=2
#
# 移行対象バージョンがDify v1.0.0からv1.3.0（v1.3.0を含まない）までの場合は、'poetry'を使用してください:
# poetry run flask install-plugins --workers=2
```

このコマンドは、最新のコミュニティ版に必要なすべてのプラグインをダウンロードしてインストールします。

最後に、プラグインのデータを移行します。このコマンドは `provider name` を更新し、`langgenius/{provider_name}/{provider_name}` を追加します

```bash
# Dify v1.3.0以降の環境では、標準コマンドは 'uv run ...' です。
uv run flask migrate-data-for-plugin
#
# 移行対象バージョンがDify v1.0.0からv1.3.0（v1.3.0を含まない）までの場合は、'poetry'を使用してください:
# poetry run flask migrate-data-for-plugin
``` 

ターミナルに結果が表示されたら、マイグレーションは完了です。

```bash
Migrate [tool_builtin_providers] data for plugin completed, total: 6
Migrate data for plugin completed.
```

## 移行結果の検証

Dify プラットフォームにアクセスし、右上の「プラグイン」ボタンをクリックして、以前使用していたツールが正しくインストールされているか確認します。ランダムにプラグインを使用して、正常に動作するかを検証します。問題がなければ、バージョンアップとデータ移行が完了したことを示しています。

![](https://assets-docs.dify.ai/2025/02/6467b3578d3d3e96510f50a09442d5a5.png)

{/*
Contributing Section
DO NOT edit this section!
It will be automatically generated by the script.
*/}

<CardGroup cols="2">
    <Card
        title="このページを編集する"
        icon="pen-to-square"
        href="https://github.com/langgenius/dify-docs/edit/main/ja-jp/development/migration/migrate-to-v1.mdx"
    >
        直接貢献することでドキュメントの改善にご協力ください
    </Card>
    <Card
        title="問題を報告する"
        icon="github"
        href="https://github.com/langgenius/dify-docs/issues/new?title=ドキュメントの問題%3A%20te-to&body=%23%23%20問題の説明%0A%3C%21--%20発見した問題について簡単に説明してください%20--%3E%0A%0A%23%23%20ページリンク%0Ahttps%3A%2F%2Fgithub.com%2Flanggenius%2Fdify-docs%2Fblob%2Fmain%2Fja-jp%2Fdevelopment%2Fmigration%2Fmigrate-to-v1.mdx%0A%0A%23%23%20提案される変更%0A%3C%21--%20特定の変更案がある場合は、ここで説明してください%20--%3E%0A%0A%3C%21--%20ドキュメントの品質向上にご協力いただきありがとうございます！%20--%3E"
    >
        エラーを見つけたり提案がありますか？お知らせください
    </Card>
</CardGroup>
